name: Generate GitHub Stats

on: 
  schedule:
    - cron: '0 0 * * *'  # 每天 UTC 时间 00:00 运行
  workflow_dispatch:  # 允许手动触发
  push:
    branches:
      - main

jobs:
  generate-stats: 
    runs-on: ubuntu-latest
    permissions:
      contents:  write
    
    steps: 
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name:  Generate GitHub Stats SVG
        uses: lowlighter/metrics@latest
        with:
          token:  ${{ secrets.GITHUB_TOKEN }}
          filename: stats/github-stats.svg
          user: bpzhang
          template:  classic
          base: header, activity, community, repositories
          config_timezone: Asia/Shanghai
          plugin_languages: yes
          plugin_languages_limit: 8
          plugin_languages_sections: most-used
      
      - name: Generate Languages SVG
        uses: lowlighter/metrics@latest
        with: 
          token: ${{ secrets. GITHUB_TOKEN }}
          filename: stats/languages.svg
          user: bpzhang
          template: classic
          base: ""
          plugin_languages: yes
          plugin_languages_limit: 8
          plugin_languages_sections: most-used
